<!DOCTYPE html>
<html>
  <head>

    <script src="//maps.google.com/maps/api/js?key=AIzaSyB8XnxZr6WHdOqtFNO5jS54IFwXoEgHPLg"></script>
    <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script>

  </head>

  <body>
    <form action = '/home/create' method = 'post'>
      <div style="display:flex; ">
      <%= link_to "", signout_path, id: "sign_out", class: "signoutbtn"%>
      <% if @posts.empty? %>
        <input style = "padding: 1px 0px 0px 12px; height: 40px; margin-top: 1.5px; margin-bottom:3px; width: 100%; font-size: 26.5px; font-family: sans-serif;" name = 'input_address' type='text' placeholder="Search Your Destination."required>
        <button class = "searchbutton" type = "submit"></button>
      <% else %>
<text style = "padding: 1px 0px 0px 12px; height: 40px; margin-top: 1.5px; margin-bottom:3px; width: 100%; font-size: 26.5px; font-family: sans-serif;">
  Your Destination is <%= @posts.first.address%>. </text>
      <%end%>
</div>
    </form>

       <div id="map"></div>

    


    <script type="text/javascript">
    var markers
    var marker
    function displayOnMap(position){
        marker = handler.addMarker({
        lat: position.coords.latitude,
        lng: position.coords.longitude,
        picture: {
            url: "http://maps.google.com/mapfiles/ms/micons/blue-dot.png",
            width:  36,
            height: 36
          }
      });
      handler.map.centerOn(marker);
    };
    handler = Gmaps.build('Google');
    // var image = 'https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png';
    handler.buildMap({ provider: {}, internal: {id: 'map'}}, function(){
      if(navigator.geolocation)
        navigator.geolocation.getCurrentPosition(displayOnMap);
        markers = handler.addMarkers(
          <%=raw @hash.to_json %>
        );
        handler.bounds.extendWith(markers);
    });
    </script>

    <script type="text/javascript">
    window.setTimeout("closesigninDiv();", 3000);
    function closesigninDiv(){
    document.getElementById("signindiv").style.display=" none";
    }

    </script>

    <% @posts.each do |p| %>
      <%= link_to p.address, home_arrive_path(:post_id => p.id) %>
    <% end %>
  </body>


</html>
